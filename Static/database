-- Crear base de datos
CREATE DATABASE IF NOT EXISTS clinica_dental CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
USE clinica_dental;

-- Tabla usuarios (pacientes)
CREATE TABLE pacientes (
  id INT AUTO_INCREMENT PRIMARY KEY,
  nombre VARCHAR(120) NOT NULL,
  correo VARCHAR(150) NOT NULL UNIQUE,
  telefono VARCHAR(30),
  creado_en TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB;

-- Tabla odontologos
CREATE TABLE odontologos (
  id INT AUTO_INCREMENT PRIMARY KEY,
  nombre VARCHAR(120) NOT NULL,
  especialidad VARCHAR(120),
  correo VARCHAR(150),
  telefono VARCHAR(30),
  creado_en TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB;

-- Tabla citas
CREATE TABLE citas (
  id INT AUTO_INCREMENT PRIMARY KEY,
  id_paciente INT NOT NULL,
  id_odontologo INT NULL,
  fecha DATE NOT NULL,
  hora TIME NOT NULL,
  servicio VARCHAR(150),
  estado ENUM('Programada','Confirmada','Completada','Cancelada') DEFAULT 'Programada',
  observaciones TEXT,
  creado_en TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (id_paciente) REFERENCES pacientes(id) ON DELETE CASCADE,
  FOREIGN KEY (id_odontologo) REFERENCES odontologos(id) ON DELETE SET NULL
) ENGINE=InnoDB;

-- Tabla administradores
CREATE TABLE administradores (
  id INT AUTO_INCREMENT PRIMARY KEY,
  usuario VARCHAR(80) NOT NULL UNIQUE,
  password VARCHAR(255) NOT NULL,
  nombre VARCHAR(120),
  creado_en TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB;

-- Insert: odontologos de ejemplo
INSERT INTO odontologos (nombre, especialidad, correo, telefono) VALUES
('Dr. John Vega R.','General','jvega@clinicadental.com','8888-0000'),
('Dra. Sofía Jiménez','Ortodoncia','sjimenez@clinicadental.com','8888-0001');

-- Insert: admin inicial (usuario: admin, password: Admin123!)
-- NOTA: el password aquí usa bcrypt hash; si lo importas por SQL, usa este hash:
INSERT INTO administradores (usuario, password, nombre) VALUES
('admin','$2y$10$Q1K8vZ9fQJQ6oN4pZbR8ge.2x0QkFzQ8pM1tD1Lq8kqXUoYKdGJ7K','Administrador');

-- -- Ejemplo paciente (opcional)
INSERT INTO pacientes (nombre, correo, telefono) VALUES
('Borbón Arias Angie','aborbon70131@ufide.ac.cr','8888-1234'),
('Alfaro Quesada Luis','lalfa70119@ufide.ac.cr','8888-2345');

-- Ejemplo cita
INSERT INTO citas (id_paciente, id_odontologo, fecha, hora, servicio, estado)
VALUES (1, 1, DATE_ADD(CURDATE(), INTERVAL 2 DAY), '10:00:00', 'Consulta General', 'Programada');
